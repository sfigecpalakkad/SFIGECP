<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Study Notes - Sahayi</title>
  <meta name="description" content="Study notes organized by department and semester">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#dc2626',
            'primary-dark': '#991b1b',
            'primary-light': '#fee2e2'
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Raleway:wght@400;600;700;800&display=swap" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">

  <style>
    * { font-family: 'Poppins', sans-serif; }
    h1, h2, h3, h4, h5, h6 { font-family: 'Raleway', sans-serif; font-weight: 700; }
    .gradient-primary { background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); }
    .dept-card {
      @apply bg-white rounded-xl shadow-lg p-6 cursor-pointer border-l-4 border-primary hover:shadow-2xl hover:scale-105 transform transition duration-300;
    }
  </style>
</head>

<body class="bg-gray-50">

  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
      <a href="../index.html" class="flex items-center gap-2 hover:opacity-80 transition">
        <div class="w-10 h-10 gradient-primary rounded-lg flex items-center justify-center">
          <i class="bi bi-book-fill text-white text-lg"></i>
        </div>
        <h1 class="text-xl font-bold text-gray-900">SFI GECP</h1>
      </a>

      <a href="./index.html" class="text-primary hover:text-primary-dark font-semibold">← Back</a>
    </nav>
  </header>

  <!-- Hero Section -->
  <section class="gradient-primary text-white py-12 px-4">
    <div class="max-w-5xl mx-auto">
      <h1 class="text-4xl font-bold mb-2">Study Notes</h1>
      <p class="text-lg opacity-90">Select your department to view available study materials</p>
    </div>
  </section>

  <!-- Main Content -->
  <section class="py-16 px-4">
    <div class="max-w-6xl mx-auto">
      
      <!-- Department Selection -->
      <div id="deptContainer" class="mb-16">
        <h2 class="text-3xl font-bold text-gray-900 mb-8">Choose Your Department</h2>
        <div id="departmentCards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Cards will be populated by JavaScript -->
        </div>
      </div>

      <!-- Semester Selection (Hidden initially) -->
      <div id="semesterContainer" class="mb-16 hidden">
        <div class="mb-8">
          <button onclick="resetSelection()" class="text-primary hover:text-primary-dark font-semibold mb-4">
            ← Change Department
          </button>
          <h2 id="semesterTitle" class="text-3xl font-bold text-gray-900">Select Semester</h2>
        </div>
        
        <div id="semesterCards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <!-- Semester cards will be populated by JavaScript -->
        </div>
      </div>

      <!-- Resources List (Hidden initially) -->
      <div id="resourcesContainer" class="mb-16 hidden">
        <div class="mb-8">
          <button onclick="resetSelection()" class="text-primary hover:text-primary-dark font-semibold mb-4">
            ← Choose Another Department
          </button>
          <h2 id="resourcesTitle" class="text-3xl font-bold text-gray-900">Available Resources</h2>
        </div>
        
        <div id="resourcesList" class="space-y-4">
          <!-- Resources will be populated by JavaScript -->
        </div>
      </div>

    </div>
  </section>

  <!-- Footer -->
  <footer class="gradient-primary text-white py-12 px-4 mt-20">
    <div class="max-w-7xl mx-auto text-center">
      <p class="opacity-80">&copy; 2025 SFI GEC Palakkad. All rights reserved.</p>
    </div>
  </footer>

  <!-- Sahayi Navigator Script -->
  <script src="../assets/js/sahayi.js"></script>
  
  <script>
    let selectedDept = null;
    let allData = null;

    async function initPage() {
      try {
        const response = await fetch('../assets/data/sahayi.json');
        allData = await response.json();
        renderDepartments();
      } catch (error) {
        console.error('Error loading data:', error);
        document.getElementById('departmentCards').innerHTML = '<p class="text-red-500">Error loading departments</p>';
      }
    }

    function renderDepartments() {
      const container = document.getElementById('departmentCards');
      container.innerHTML = '';

      allData.departments.forEach(dept => {
        const card = document.createElement('div');
        card.className = 'dept-card';
        card.innerHTML = `
          <div class="flex items-center gap-4">
            <div class="w-14 h-14 bg-primary-light rounded-lg flex items-center justify-center">
              <i class="bi ${dept.icon} text-primary text-2xl"></i>
            </div>
            <div>
              <h3 class="font-bold text-gray-900 text-lg">${dept.name}</h3>
              <p class="text-gray-600 text-sm">Select to view notes</p>
            </div>
          </div>
        `;
        card.onclick = () => selectDepartment(dept.id, dept.name);
        container.appendChild(card);
      });
    }

    function selectDepartment(deptId, deptName) {
      selectedDept = { id: deptId, name: deptName };
      document.getElementById('deptContainer').style.display = 'none';
      document.getElementById('semesterContainer').style.display = 'block';
      document.getElementById('semesterTitle').textContent = `${deptName} - Select Semester`;
      renderSemesters();
      window.scrollTo(0, 0);
    }

    function renderSemesters() {
      const container = document.getElementById('semesterCards');
      container.innerHTML = '';

      allData.semesters.forEach(semester => {
        const card = document.createElement('button');
        card.className = 'bg-white rounded-lg shadow-md p-4 hover:shadow-lg hover:bg-primary-light transition text-center font-bold text-primary-dark hover:text-primary';
        card.textContent = semester;
        card.onclick = () => selectSemester(semester);
        container.appendChild(card);
      });
    }

    function selectSemester(semester) {
      const resources = allData.resources.notes.filter(r => 
        r.department === selectedDept.id && r.semester === semester
      );

      document.getElementById('semesterContainer').style.display = 'none';
      document.getElementById('resourcesContainer').style.display = 'block';
      document.getElementById('resourcesTitle').textContent = `${selectedDept.name} - ${semester} Notes`;
      
      renderResources(resources);
      window.scrollTo(0, 0);
    }

    function renderResources(resources) {
      const container = document.getElementById('resourcesList');
      container.innerHTML = '';

      if (resources.length === 0) {
        container.innerHTML = '<p class="text-gray-600 text-lg">No resources available for this selection.</p>';
        return;
      }

      resources.forEach(resource => {
        const item = document.createElement('a');
        item.href = resource.gdrive_url;
        item.target = '_blank';
        item.rel = 'noopener noreferrer';
        item.className = 'block bg-white rounded-lg shadow-md p-6 hover:shadow-lg hover:bg-primary-light transition border-l-4 border-primary';
        item.innerHTML = `
          <div class="flex items-center justify-between">
            <div>
              <h3 class="font-bold text-gray-900 text-lg">${resource.title}</h3>
              <p class="text-gray-600 text-sm mt-1">Click to open in Google Drive</p>
            </div>
            <i class="bi bi-box-arrow-up-right text-primary text-2xl"></i>
          </div>
        `;
        container.appendChild(item);
      });
    }

    function resetSelection() {
      selectedDept = null;
      document.getElementById('deptContainer').style.display = 'block';
      document.getElementById('semesterContainer').style.display = 'none';
      document.getElementById('resourcesContainer').style.display = 'none';
      window.scrollTo(0, 0);
    }

    // Initialize page on load
    window.addEventListener('DOMContentLoaded', initPage);
  </script>

</body>

</html>
